
- Lista de Alunos 

Nome: Gustavo Ruas de Goes RA: 2202021
Nome: Luan Cunha Faustino RA: 2202108
Nome: Felipe da Silva Robliotta RA: 2200276
-------------------------------------------------------


IF TableSelectCount(tblCadastroAluno) = 0 THEN
	Info("Nada foi selecionado")
	RETURN	
END

Open(frmAluno,"Consultar",tblCadastroAluno.cIdMatricula,cMatricula)
 

[b] Com isso ele chama o tela frmAluno e passa os parametros:

2. na tela Forme, a tela que abre ao selecionar o consultar, ela abre com esses parametros quando cai no switch case: 
		
		
	CASE "Consultar"
		stcTitulo = "Consultar "
		locPreencher()
		edtMatricula..State  = DisplayOnly
		edtTelefone	..State  = DisplayOnly
		edtNome..State  = DisplayOnly
		edtIdade..State  = DisplayOnly
		edtCep..State  = DisplayOnly
		edtEndereco..State  = DisplayOnly
		edtNumeroCasa1..State  = DisplayOnly
		edtBairro..State  = DisplayOnly
		edtCidade..State  = DisplayOnly
		edtEstado..State  = DisplayOnly
		btnGravar..DisplayEnabled = False
		
		
		Group1..State = DisplayOnly
				
	OTHER CASE
		
    PROCEDURE locPreencher()

    sqlPreencher is string
    
    sqlPreencher = [
        SELECT 
        
        matricula 
        ,nomeCompleto   
        ,idade			
        ,telefone		
        ,cep		
        ,endereco	
        ,numeroCasa
        ,bairro
        ,cidade						
        ,estado			
        
    FROM
        Aluno
    WHERE
        idMatricula = %1
            
    ]
    
    ds is Data Source
    
    sqlPreencher = StringBuild(sqlPreencher,cidMatricula)
    
    IF NOT HExecuteSQLQuery(ds,ConectarBanco.Conexao,hQueryWithoutCorrection,sqlPreencher) THEN
        Error("Erro ao resgatar dados!")
        Close(MyWindow)
        
    ELSE
        HReadFirst(ds)
        IF HFound(ds) THEN
            edtMatricula 	= ds.matricula
            edtNome			= ds.nomeCompleto
            edtIdade		= ds.idade
            edtTelefone		= ds.telefone
            edtCep			= ds.CEP
            edtEndereco		= ds.endereco
            edtNumeroCasa1	= ds.numeroCasa
            edtBairro		= ds.bairro
            edtCidade		= ds.Cidade
            edtEstado		= ds.Estado
            
        END
    
    END

    Dentro da local procedure, locApagar:

//
PROCEDURE locApagar()
dsApagar is Data Source
resultado is boolean


IF TableSelectCount(tblCadastroAluno) = 0 THEN
	Info("Nenhum item selecionado")
	RETURN
END

IF TableCount(tblCadastroAluno) > 0 THEN
	IF YesNo("Podemos Apagar este codigo") THEN
		
		HourGlass(True) // Inativa a janela ate o usuario selecionar, sim ou não
		
	SQLdelete is string = "delete from Aluno where idMatricula = %1"
			
			SQLdelete = StringBuild(SQLdelete,tblCadastroAluno.cIdMatricula)
			
			
			HFreeQuery(dsApagar)
IF NOT HExecuteSQLQuery(dsApagar,ConectarBanco.Conexao,hQueryWithoutCorrection,SQLdelete) THEN
				Info(HErrorInfo())
				HFreeQuery(dsApagar)
				RETURN
			ELSE 
				Info("Registro excluido com sucesso")
			END
			
			HFreeQuery(dsApagar)
			ExecuteProcess(btnPesquisar,trtClick)
		END 
		END
		
	END